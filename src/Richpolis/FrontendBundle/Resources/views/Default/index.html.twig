{% extends 'FrontendBundle::layout.html.twig' %}

{% block stylesheets %}
    {{  parent()  }}
    <link rel="stylesheet" href="{{asset('css/jquery.bxslider.css')}}">
    <link rel="stylesheet" href="{{asset('css/fancybox/jquery.fancybox.css')}}"/>
    <style>
    .bx-wrapper .bx-viewport{
        padding: 0px;
        border: none;
        top: 0px;
        left: 0px;
    }
    
    </style>
{% endblock %}

{% block header_class 'inicio' %}

{% block contenido %}
            <article class="slide-principal">
                <div class="slide-contenedor">
                    <ul class="slideGaleria">
                            {% for publicacion in categoria.publicaciones %}
                            <li>
                                <a href="{{path('frontend_tours')}}#destino-{{publicacion.slug}}">
                                    <img src="{{ publicacion.webPath | apply_filter('publicaciones_carrusel')  }}" title="">
                                    <div class="descripcion-publicacion" style="width: 100%;">
										<h3>
											{{publicacion.titulo(locale)}}
										</h3>
										{{ publicacion.descripcion(locale)|raw }}
									</div>
                                </a>
                            </li>
                            {% endfor %}
                    </ul>
                </div>
            </article>
            <article class="twitters">
                
            </article>
<!-- Modal -->
<div class="modal fade" id="formNewsletter" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        {% include 'FrontendBundle:Default:formNewsletter.html.twig' with {'form': form}%}
    </div>    
</div>                                
                                
{% endblock %}
{% block javascripts %}
{{ parent() }}
<script src="{{asset('js/jquery.bxslider.js')}}"></script>
<script src="{{asset('js/main.js')}}"></script>
<script src="{{asset('js/fancybox/jquery.fancybox.pack.js')}}"></script>
<script src="{{asset('js/fancybox/jquery.fancybox-media.js')}}"></script>
<script>
$(document).on("ready",function(){
        setTimeout(function(){
            iniciarCircle();
        },6000);

        $('.sliderDestinos').bxSlider({
            randomStart: false,
            pager: false,
            auto: true,
            controls: false,
            speed: 1000,
            autoHover: true,
        });
		
        $('.sliderEventos').bxSlider({
            randomStart: false,
            pager: false,
            auto: true,
            controls: false,
            speed: 1000,
            autoHover: true,
        });

        
        $("a.fancybox").fancybox();
                
        $("a.fancybox-media").fancybox({
            helpers : {
                media: true
            },
            youtube : {
                autoplay: 0
            }
        });
        iniciarlizarFormNewsletter();
        
        $('.experiencias').carousel({
            interval: 5000,
            pause: "hover",
        })

});
var iniciarCircle=function(){
        $('ul.twitter-feed li:first-child').slideUp("slow",function(){
            $('ul.twitter-feed').append($(this).slideDown("fast"));
        });
                 
        setTimeout(function(){
            iniciarCircle();
        },6000);
                    
}
function iniciarlizarFormNewsletter(){
    $("input.form-submit").click( function() {
        debugger;
        $('img.ajax-loader').css({visibility: 'visible'});
        $("img.ajax-loader").fadeIn("fast",function(){
            $.post("{{path('frontend_form_newsletter')}}",
            $("form.form-newsletter").serialize(),
            function(data){
                actualizaFormularioNewsletter(data.vista);
                if(data.ok){
                    setInterval(function(){
                        $( "#formNewsletter" ).modal( "hide" );
                    },2000);
                }
                setInterval(function(){
                    $("#formulario_newsletter").find(".form-response-output").fadeOut("fast");
                },2000);
                
            });    
        });
    });
}

function actualizaFormularioNewsletter(data){
  $("#formulario_newsletter").parent().html(data);
  iniciarlizarFormNewsletter();
}
    
</script>
{% endblock %}

